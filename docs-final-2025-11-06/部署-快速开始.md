# ProxyHub 腾讯云部署 - 快速开始

**5步完成部署** 🚀

---

## 📋 准备工作

### 你需要：
- ✅ 腾讯云服务器（2核4GB，Ubuntu 20.04/22.04）
- ✅ 服务器公网IP
- ✅ 985Proxy API密钥

---

## 🚀 部署步骤

### 步骤 1: 上传自动化脚本到服务器

**在本地Windows PowerShell执行**:

```powershell
# 进入项目目录
cd D:\Users\Desktop\proxyhub

# 上传部署脚本
scp deploy-tencentcloud.sh root@你的服务器IP:/root/
```

**替换** `你的服务器IP` 为实际IP地址

---

### 步骤 2: 连接到服务器

```powershell
ssh root@你的服务器IP
```

输入密码登录

---

### 步骤 3: 运行自动化部署脚本

```bash
# 赋予执行权限
chmod +x /root/deploy-tencentcloud.sh

# 运行脚本
/root/deploy-tencentcloud.sh
```

**脚本会自动完成**:
- ✅ 安装Docker和Docker Compose
- ✅ 创建项目目录
- ✅ 生成安全密钥
- ✅ 配置环境变量（会提示输入985Proxy API密钥）

---

### 步骤 4: 上传项目文件

**脚本会暂停，提示你上传项目文件**

**方法1: 使用SCP（命令行）**

在本地Windows PowerShell执行:

```powershell
# 打包项目
cd D:\Users\Desktop\proxyhub
tar --exclude='node_modules' --exclude='.git' --exclude='dist' -czf proxyhub.tar.gz .

# 上传到服务器
scp proxyhub.tar.gz root@你的服务器IP:/opt/proxyhub/
```

**方法2: 使用WinSCP（图形界面，推荐新手）**

1. 下载WinSCP: https://winscp.net/
2. 连接信息:
   - 主机名: 你的服务器IP
   - 用户名: root
   - 密码: 你的密码
3. 左边选择本地 `D:\Users\Desktop\proxyhub`
4. 右边打开 `/opt/proxyhub`
5. 将所有文件拖拽上传

**上传完成后，回到SSH终端，按Enter继续**

---

### 步骤 5: 配置腾讯云安全组

**登录腾讯云控制台**:

1. 进入 **云服务器** → **安全组**
2. 找到你的服务器使用的安全组
3. 点击 **修改规则** → **入站规则**
4. 添加以下规则:

| 类型 | 来源 | 协议端口 | 策略 |
|------|------|----------|------|
| 自定义 | 0.0.0.0/0 | TCP:80 | 允许 |
| 自定义 | 0.0.0.0/0 | TCP:443 | 允许 |
| 自定义 | 0.0.0.0/0 | TCP:3000 | 允许 |
| 自定义 | 0.0.0.0/0 | TCP:8080 | 允许 |

5. 保存规则

---

## ✅ 验证部署

### 访问应用

**前端**:
```
http://你的服务器IP:8080
```

**后端API**:
```
http://你的服务器IP:3000/api/v1
```

**API文档**:
```
http://你的服务器IP:3000/api
```

### 测试登录

**管理员账号**:
- 邮箱: `admin@example.com`
- 密码: `admin123`

**普通用户**:
- 邮箱: `alice@test.com`
- 密码: `password123`

---

## 📊 检查服务状态

```bash
# 进入项目目录
cd /opt/proxyhub

# 查看容器状态
docker compose ps

# 查看日志
docker compose logs -f
```

**期望看到4个容器都在运行**:
- proxyhub-frontend (Up)
- proxyhub-backend (Up, healthy)
- proxyhub-db (Up, healthy)
- proxyhub-redis (Up, healthy)

---

## 🔧 常用命令

```bash
# 查看所有日志
cd /opt/proxyhub && docker compose logs -f

# 查看后端日志
cd /opt/proxyhub && docker compose logs -f backend

# 重启所有服务
cd /opt/proxyhub && docker compose restart

# 停止服务
cd /opt/proxyhub && docker compose stop

# 启动服务
cd /opt/proxyhub && docker compose start
```

---

## 🆘 遇到问题?

### 1. 无法访问前端

**检查**:
```bash
# 确认容器运行
docker compose ps

# 查看前端日志
docker compose logs frontend

# 确认端口开放
netstat -tlnp | grep 8080
```

### 2. 登录失败/API错误

**检查**:
```bash
# 查看后端日志
docker compose logs backend

# 检查环境变量
cat backend/.env.production
```

### 3. 数据库连接失败

**检查**:
```bash
# 测试数据库连接
docker compose exec db pg_isready -U proxyhub

# 查看数据库日志
docker compose logs db
```

---

## 🌐 后续优化（可选）

### 配置域名和HTTPS

查看详细指南:
```
docs-final-2025-11-06/腾讯云Docker部署指南.md
```

章节: "配置域名和HTTPS"

### 性能优化

- 启用Nginx反向代理
- 配置CDN加速
- 优化数据库连接池
- 启用Redis持久化

---

## 📝 下一步

1. ✅ 修改管理员密码
2. ✅ 配置SMTP邮件服务
3. ✅ 配置Telegram通知
4. ✅ 设置定期数据库备份
5. ✅ 绑定域名并配置SSL

---

## 🎉 完成！

恭喜！ProxyHub已成功部署到腾讯云！

**重要提醒**:
- 📌 生产环境请立即修改管理员密码
- 📌 定期备份数据库
- 📌 监控服务器资源使用情况
- 📌 配置HTTPS保护用户数据安全

有任何问题，请查看:
- 完整部署指南: `docs-final-2025-11-06/腾讯云Docker部署指南.md`
- 常见问题: 指南中的"故障排查"章节

