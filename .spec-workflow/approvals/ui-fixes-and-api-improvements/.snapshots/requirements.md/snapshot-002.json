{
  "id": "snapshot_1762757064522_b1iwh6z7j",
  "approvalId": "approval_1762755972559_mv6145442",
  "approvalTitle": "UI修复和API改进 - 需求文档",
  "version": 2,
  "timestamp": "2025-11-10T06:44:24.522Z",
  "trigger": "approved",
  "status": "pending",
  "content": "# UI修复和API改进 - 需求文档\r\n\r\n## 1. 功能概述\r\n\r\n### 1.1 背景\r\nProxyHub系统当前存在多个UI渲染问题、API连接问题和硬编码数据问题，影响用户体验和系统功能完整性。本次改进旨在全面修复这些问题，提升系统质量。\r\n\r\n### 1.2 目标\r\n- 修复所有P0级API连接问题\r\n- 重构账户中心UI为左右布局\r\n- 修复仪表盘卡片渲染问题\r\n- 实现数据动态化（移除硬编码）\r\n- 完善移动端响应式设计\r\n\r\n### 1.3 范围\r\n**包含：**\r\n- 985Proxy API连接修复\r\n- 价格覆盖API端点修复\r\n- 账户中心页面重构\r\n- 仪表盘UI修复\r\n- 待处理事项数据动态化\r\n- 移动端响应式改进\r\n\r\n**不包含：**\r\n- 新功能开发\r\n- 数据库结构变更\r\n- 第三方服务集成（已有的除外）\r\n\r\n---\r\n\r\n## 2. 用户故事\r\n\r\n### 2.1 P0 - 关键功能修复\r\n\r\n#### US-001: 985Proxy API连接修复\r\n**作为** 系统管理员  \r\n**我想要** 系统能正常连接985Proxy API  \r\n**以便于** 获取IP库存、业务场景等数据\r\n\r\n**验收标准：**\r\n- [ ] API KEY配置正确且有效\r\n- [ ] 所有985Proxy相关API调用成功返回200\r\n- [ ] 静态住宅选购页面能正常加载库存数据\r\n- [ ] 业务场景下拉框能正常显示选项\r\n- [ ] 控制台不再显示400错误\r\n\r\n**EARS场景：**\r\n```\r\nWHEN 用户访问静态住宅选购页面\r\nAND 页面初始化加载数据\r\nTHEN 系统应成功调用985Proxy API\r\nAND 返回有效的库存和业务场景数据\r\nAND 不显示任何API错误提示\r\n```\r\n\r\n---\r\n\r\n#### US-002: 价格覆盖功能API修复\r\n**作为** 系统管理员  \r\n**我想要** 在用户管理中为单个用户设置价格覆盖  \r\n**以便于** 为不同用户提供个性化定价\r\n\r\n**验收标准：**\r\n- [ ] 点击\"价格覆盖\"按钮能成功打开对话框\r\n- [ ] 对话框能成功加载用户的IP池数据\r\n- [ ] API端点 `GET /api/v1/price/user-ip-pool/:userId` 正常工作\r\n- [ ] API端点 `POST /api/v1/price/user-overrides/:userId/batch` 正常工作\r\n- [ ] 保存价格覆盖后能即时生效\r\n- [ ] 不显示\"无法获取用户价格信息\"错误\r\n\r\n**EARS场景：**\r\n```\r\nGIVEN 管理员在用户管理页面\r\nWHEN 点击某个用户的\"价格覆盖\"按钮\r\nTHEN 系统应打开价格覆盖对话框\r\nAND 成功加载该用户的IP池数据\r\nAND 允许管理员修改价格\r\nAND 保存后立即生效\r\n```\r\n\r\n---\r\n\r\n### 2.2 P1 - UI/UX改进\r\n\r\n#### US-003: 账户中心页面重构\r\n**作为** 普通用户  \r\n**我想要** 在账户中心看到清晰的左右布局  \r\n**以便于** 快速找到账户信息和常用操作\r\n\r\n**验收标准：**\r\n- [ ] 页面采用左右分栏布局（60% + 40%）\r\n- [ ] 左侧显示：登录密码、邮箱绑定、通知设置等账户信息\r\n- [ ] 右侧显示：快捷操作卡片 + 联系客服卡片\r\n- [ ] 快捷操作包含：订购静态IP、动态代理管理、静态IP管理、查看订单\r\n- [ ] 联系客服显示：客服信息、工作时间、平均响应时间\r\n- [ ] 移动端自动调整为上下布局\r\n\r\n**EARS场景：**\r\n```\r\nWHEN 用户访问\"我的账户\" -> \"账户中心\"页面\r\nTHEN 系统应显示左右分栏布局\r\nWHERE 左侧60%显示账户信息\r\nAND 右侧40%显示快捷操作和客服信息\r\nIF 设备宽度 < 768px THEN 自动切换为上下布局\r\n```\r\n\r\n**UI设计规范：**\r\n```\r\n┌─────────────────────────────────────────────────────┐\r\n│  账户中心                                  [修改密码]  │\r\n├───────────────────────┬─────────────────────────────┤\r\n│  【左侧 60%】          │  【右侧 40%】                │\r\n│                       │                             │\r\n│  📱 登录密码          │  🚀 快捷操作                 │\r\n│  ✉️ 邮箱绑定          │  - 订购静态IP                │\r\n│  🔔 通知设置          │  - 动态代理管理              │\r\n│                       │  - 静态IP管理                │\r\n│                       │  - 查看订单                  │\r\n│                       │                             │\r\n│                       │  💬 联系客服                 │\r\n│                       │  - 客服信息                  │\r\n│                       │  - 工作时间                  │\r\n│                       │  - 响应时间                  │\r\n└───────────────────────┴─────────────────────────────┘\r\n```\r\n\r\n---\r\n\r\n#### US-004: 仪表盘卡片渲染修复\r\n**作为** 用户  \r\n**我想要** 仪表盘顶部的统计卡片正常显示  \r\n**以便于** 快速了解系统概况\r\n\r\n**验收标准：**\r\n- [ ] 4个统计卡片完整显示（总代理数、活跃代理、总订单数、总消费）\r\n- [ ] 卡片宽度正确，不会被截断\r\n- [ ] 卡片图标和文字对齐正常\r\n- [ ] 数字和标签清晰可读\r\n- [ ] 响应式布局正常（移动端2列显示）\r\n\r\n**EARS场景：**\r\n```\r\nWHEN 用户访问仪表盘页面\r\nTHEN 顶部应显示4个统计卡片\r\nAND 每个卡片完整可见\r\nAND 卡片内容正确对齐\r\nAND 文字清晰可读\r\nIF 设备宽度 < 768px THEN 卡片2列显示\r\n```\r\n\r\n---\r\n\r\n#### US-005: 待处理事项数据动态化\r\n**作为** 系统管理员  \r\n**我想要** 看到真实的待处理事项数量  \r\n**以便于** 及时处理需要审核的业务\r\n\r\n**验收标准：**\r\n- [ ] 移除硬编码的数字\"3\"\r\n- [ ] 充值审核数量从数据库实时查询\r\n- [ ] 异常订单数量从数据库实时查询\r\n- [ ] 系统通知数量从数据库实时查询\r\n- [ ] 数字为0时显示\"0\"而不是隐藏\r\n- [ ] 点击各项能跳转到对应页面\r\n\r\n**EARS场景：**\r\n```\r\nWHEN 管理员打开管理后台\r\nTHEN 系统应查询数据库获取待处理事项\r\nAND 显示真实的充值审核数量\r\nAND 显示真实的异常订单数量\r\nAND 显示真实的系统通知数量\r\nAND 总数应为以上三项之和\r\n```\r\n\r\n---\r\n\r\n#### US-006: 移动端响应式完善\r\n**作为** 移动端用户  \r\n**我想要** 所有页面在手机上正常显示  \r\n**以便于** 随时随地管理代理服务\r\n\r\n**验收标准：**\r\n- [ ] 账户中心页面移动端布局正常\r\n- [ ] 仪表盘图表在移动端可正常滚动\r\n- [ ] 价格覆盖对话框在移动端尺寸合适\r\n- [ ] 表格在移动端支持横向滚动\r\n- [ ] 按钮和输入框在移动端大小合适（最小44px）\r\n- [ ] 文字在移动端可读（最小14px）\r\n\r\n**EARS场景：**\r\n```\r\nGIVEN 用户使用移动设备访问系统\r\nWHEN 浏览任意页面\r\nTHEN 所有元素应适应屏幕宽度\r\nAND 文字清晰可读（≥14px）\r\nAND 按钮易于点击（≥44px）\r\nAND 表格支持横向滚动\r\nAND 图表自适应容器宽度\r\n```\r\n\r\n---\r\n\r\n## 3. 非功能需求\r\n\r\n### 3.1 性能要求\r\n- API响应时间 < 2秒\r\n- 页面首次加载时间 < 3秒\r\n- UI渲染无明显卡顿\r\n\r\n### 3.2 兼容性要求\r\n- 桌面端：Chrome 90+、Firefox 88+、Safari 14+、Edge 90+\r\n- 移动端：iOS Safari 14+、Android Chrome 90+\r\n- 屏幕尺寸：320px ~ 3840px\r\n\r\n### 3.3 可用性要求\r\n- 错误提示清晰明确\r\n- 加载状态有明确指示\r\n- 操作有即时反馈\r\n\r\n### 3.4 可维护性要求\r\n- 代码遵循项目现有规范\r\n- 组件高度复用\r\n- 注释清晰完整\r\n\r\n---\r\n\r\n## 4. 约束条件\r\n\r\n### 4.1 技术约束\r\n- 必须使用Vue 3 + TypeScript\r\n- 必须使用Element Plus UI组件库\r\n- 必须保持与现有架构一致\r\n\r\n### 4.2 业务约束\r\n- 不改变现有业务逻辑\r\n- 不影响现有功能正常使用\r\n- 向下兼容现有数据\r\n\r\n### 4.3 时间约束\r\n- 预计开发时间：2-3小时\r\n- 测试和修复时间：1小时\r\n\r\n---\r\n\r\n## 5. 依赖关系\r\n\r\n### 5.1 外部依赖\r\n- 985Proxy API服务正常\r\n- 数据库服务正常\r\n- Redis缓存服务正常\r\n\r\n### 5.2 内部依赖\r\n- 现有的认证授权模块\r\n- 现有的价格管理模块\r\n- 现有的订单管理模块\r\n\r\n---\r\n\r\n## 6. 风险评估\r\n\r\n### 6.1 技术风险\r\n| 风险 | 影响 | 概率 | 缓解措施 |\r\n|------|------|------|----------|\r\n| 985Proxy API不稳定 | 高 | 中 | 添加重试机制和降级处理 |\r\n| 价格覆盖逻辑复杂 | 中 | 低 | 完善测试覆盖 |\r\n| 响应式适配兼容性 | 中 | 中 | 多设备测试 |\r\n\r\n### 6.2 业务风险\r\n| 风险 | 影响 | 概率 | 缓解措施 |\r\n|------|------|------|----------|\r\n| 影响现有功能 | 高 | 低 | 回归测试 |\r\n| 数据不一致 | 中 | 低 | 数据验证 |\r\n\r\n---\r\n\r\n## 7. 成功标准\r\n\r\n### 7.1 功能完整性\r\n- ✅ 所有P0问题已修复\r\n- ✅ 所有P1问题已修复\r\n- ✅ 所有验收标准通过\r\n\r\n### 7.2 代码质量\r\n- ✅ 无TypeScript编译错误\r\n- ✅ 无ESLint警告\r\n- ✅ 代码审查通过\r\n\r\n### 7.3 用户验收\r\n- ✅ 用户测试反馈良好\r\n- ✅ 无遗留严重问题\r\n\r\n---\r\n\r\n## 8. 附录\r\n\r\n### 8.1 术语表\r\n- **P0**: 最高优先级，阻塞性问题\r\n- **P1**: 高优先级，严重影响用户体验\r\n- **EARS**: Event-Action-Result-State，需求描述方法\r\n\r\n### 8.2 参考资料\r\n- Element Plus文档: https://element-plus.org/\r\n- Vue 3响应式设计最佳实践\r\n- 移动端适配规范\r\n\r\n\r\n\r\n",
  "fileStats": {
    "size": 9367,
    "lines": 309,
    "lastModified": "2025-11-10T06:44:07.477Z"
  },
  "comments": []
}