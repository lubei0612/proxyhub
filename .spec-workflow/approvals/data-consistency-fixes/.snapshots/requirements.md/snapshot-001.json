{
  "id": "snapshot_1762409471273_i86iyayl2",
  "approvalId": "approval_1762409471250_snkt5vryz",
  "approvalTitle": "数据一致性修复 - 需求规格",
  "version": 1,
  "timestamp": "2025-11-06T06:11:11.272Z",
  "trigger": "initial",
  "status": "pending",
  "content": "# 数据一致性修复 - 需求规格\r\n\r\n**创建日期**: 2025-11-06  \r\n**优先级**: P0 (最高)  \r\n**状态**: Draft\r\n\r\n---\r\n\r\n## 1. 项目背景\r\n\r\n用户在测试过程中发现大量数据一致性问题和硬编码假数据，严重影响用户体验和系统可信度。\r\n\r\n## 2. 问题清单\r\n\r\n### P0-1: 静态IP管理页面显示问题\r\n**当前状态**: 表格空白  \r\n**预期**: 显示用户已购买的IP列表  \r\n**影响**: 用户无法查看和管理已购买的IP\r\n\r\n### P0-2: 仪表盘数据不一致\r\n**问题**:\r\n1. 总代理数20 vs 活跃代理31（数字矛盾）\r\n2. 总消费$100.00（数据来源不明）\r\n3. 未使用流量却有流量统计图数据（假数据）\r\n4. 管理后台普通用户显示680个（明显错误）\r\n5. 收入趋势不准确\r\n6. 今日新增显示+0（实际今天有购买IP）\r\n\r\n**根因**: 疑似使用硬编码的假数据\r\n\r\n### P0-3: 事件日志筛选失效\r\n**问题**: 点击事件类型筛选无效果  \r\n**影响**: 无法按类型查看事件\r\n\r\n### P0-4: 账单和订单数据一致性\r\n**需要验证**:\r\n- 账单明细\r\n- 订单管理\r\n- 交易明细\r\n- 结算记录\r\n- 充值订单\r\n\r\n### P0-5: 用户管理功能验证\r\n**需要**: 全面测试用户管理的所有功能\r\n\r\n### P0-6: 价格覆盖管理IP池来源\r\n**需要确认**: IP池数据是否来自985Proxy API\r\n\r\n---\r\n\r\n## 3. 核心需求\r\n\r\n### FR1: 移除所有硬编码假数据\r\n**优先级**: P0  \r\n**描述**: 系统不应包含任何硬编码的测试数据，所有数据必须从数据库实时计算\r\n\r\n**验收标准**:\r\n- ✅ 仪表盘所有统计数据来自数据库\r\n- ✅ 图表数据基于真实使用记录\r\n- ✅ 今日新增等实时数据正确计算\r\n\r\n### FR2: 修复数据一致性问题\r\n**优先级**: P0  \r\n**描述**: 确保所有页面显示的数据逻辑一致\r\n\r\n**验收标准**:\r\n- ✅ 代理数量统计准确（总数 >= 活跃数）\r\n- ✅ 订单和消费数据匹配\r\n- ✅ 用户数量统计准确\r\n- ✅ 收入数据与订单金额一致\r\n\r\n### FR3: 修复事件日志筛选\r\n**优先级**: P0  \r\n**描述**: 事件类型筛选功能正常工作\r\n\r\n**验收标准**:\r\n- ✅ 选择事件类型后正确过滤\r\n- ✅ 清除筛选后恢复所有数据\r\n\r\n### FR4: 静态IP列表正确显示\r\n**优先级**: P0  \r\n**描述**: 用户可以查看已购买的所有IP\r\n\r\n**验收标准**:\r\n- ✅ 表格显示所有IP\r\n- ✅ 数据字段完整\r\n- ✅ 支持筛选和排序\r\n\r\n---\r\n\r\n## 4. 非功能需求\r\n\r\n### NFR1: 性能要求\r\n- 仪表盘加载时间 < 2秒\r\n- 列表查询响应时间 < 1秒\r\n\r\n### NFR2: 数据准确性\r\n- 统计数据实时准确率 100%\r\n- 不允许出现负数或不合理值\r\n\r\n### NFR3: 用户体验\r\n- 所有功能必须可用\r\n- 错误提示清晰明确\r\n- 数据加载状态明显\r\n\r\n---\r\n\r\n## 5. 成功标准\r\n\r\n1. ✅ 所有硬编码假数据已移除\r\n2. ✅ 所有统计数据准确无误\r\n3. ✅ 所有筛选功能正常工作\r\n4. ✅ Chrome DevTools测试100%通过\r\n5. ✅ 用户测试反馈满意\r\n\r\n---\r\n\r\n## 6. 风险评估\r\n\r\n| 风险 | 影响 | 概率 | 缓解措施 |\r\n|------|------|------|----------|\r\n| 假数据分布广泛 | 高 | 高 | 全面代码审查 |\r\n| 数据库数据不足 | 中 | 中 | 使用种子数据 |\r\n| 性能问题 | 中 | 低 | 优化查询语句 |\r\n\r\n---\r\n\r\n## 7. 时间估算\r\n\r\n- 代码审查和定位: 30分钟\r\n- 修复实现: 1小时\r\n- 测试验证: 30分钟\r\n- **总计**: 2小时\r\n\r\n",
  "fileStats": {
    "size": 3431,
    "lines": 135,
    "lastModified": "2025-11-06T06:11:09.675Z"
  },
  "comments": []
}