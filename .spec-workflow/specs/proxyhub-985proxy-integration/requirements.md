# ProxyHub 985Proxy 完整集成与前端复刻 - 需求文档

## 1. 概述

**规范名称**: proxyhub-985proxy-integration  
**创建日期**: 2025-11-02  
**状态**: 草稿  
**版本**: 1.0.0

### 1.1 目标

完整复刻原 ProxyHub 项目的所有前端功能，并集成 985Proxy 开放 API，实现一个功能完整的代理IP管理平台。

### 1.2 利益相关方

- **最终用户**: 需要使用代理IP服务的客户
- **管理员**: 平台运营人员
- **开发团队**: 项目维护和扩展人员

### 1.3 成功标准

- 所有前端页面与原项目完全一致
- 985Proxy API 完整集成并正常工作
- 所有功能经过测试并可正常使用
- 后端服务稳定运行，无端口冲突
- 数据可视化图表正确显示

---

## 2. 核心功能需求

### 2.1 后端修复

#### REQ-001: 解决端口占用问题
**优先级**: 🔴 Critical  
**作为** 系统管理员  
**我想要** 后端服务能正常启动而不会出现端口冲突  
**以便** 系统能够稳定运行

**接受标准**:
- WHEN 启动后端服务时
- THEN 服务应该在端口 3000 成功启动
- AND 不应该有任何 EADDRINUSE 错误
- AND 服务应该能够响应 API 请求

---

### 2.2 仪表盘 (Dashboard)

#### REQ-002: 使用流量概况条形图
**优先级**: 🔴 Critical  
**作为** 用户  
**我想要** 查看不同代理类型的流量使用情况  
**以便** 了解我的代理使用分布

**接受标准**:
- WHEN 访问仪表盘页面时
- THEN 应该显示条形图，包含以下类别：
  - 数据中心 (Data Center)
  - 双ISP静态住宅 (Dual ISP Static)
  - 动态住宅 (Rotating Residential)
  - 移动代理 (Mobile)
- AND 应该有日期筛选器（基于UTC时间）
- AND 图表应该使用 ECharts 实现

#### REQ-003: 网络请求饼状图
**优先级**: 🔴 Critical  
**作为** 用户  
**我想要** 查看不同代理类型的网络请求分布  
**以便** 了解我的使用模式

**接受标准**:
- WHEN 访问仪表盘页面时
- THEN 应该显示饼状图，包含相同的代理类别
- AND 应该支持 UTC 时间筛选
- AND 图表应该响应式显示

#### REQ-004: 流量使用折线图
**优先级**: 🔴 Critical  
**作为** 用户  
**我想要** 查看随时间变化的流量使用趋势  
**以便** 分析我的使用模式

**接受标准**:
- WHEN 访问仪表盘页面时
- THEN 应该显示折线图，包含以下系列：
  - dc (数据中心)
  - mobile (移动代理)
  - res_rotating (动态住宅)
  - res_static (静态住宅)
- AND 图表应该支持时间范围选择

---

### 2.3 动态住宅 (Rotating Residential)

#### REQ-005: 动态住宅管理页面
**优先级**: 🟡 High  
**作为** 用户  
**我想要** 管理我的动态住宅代理通道  
**以便** 查看和管理我的代理资源

**接受标准**:
- WHEN 访问动态住宅管理页面时
- THEN 应该显示我的所有通道列表
- AND 每个通道应该显示：通道名、费用、通道限制、节点ID、备注
- AND 应该有搜索和筛选功能
- AND 应该与 985Proxy API `/res_rotating/` 集成

#### REQ-006: 动态住宅选购页面（联系客服模式）
**优先级**: 🟡 High  
**作为** 用户  
**我想要** 了解动态住宅价格和联系客服购买  
**以便** 购买适合我的服务

**接受标准**:
- WHEN 访问动态住宅选购页面时
- THEN 应该显示价格表和套餐信息
- AND 应该有"联系客服"按钮，因为没有购买API
- AND 价格表应该模仿原项目设计

---

### 2.4 静态住宅 (Static Residential)

#### REQ-007: 静态住宅管理页面
**优先级**: 🔴 Critical  
**作为** 用户  
**我想要** 管理我的静态代理IP  
**以便** 查看、续费、导出我的代理列表

**接受标准**:
- WHEN 访问静态住宅管理页面时
- THEN 应该显示我的所有静态IP列表
- AND 每个IP应该显示：
  - IP列表
  - IP:端口:账号:密码
  - 国家/城市
  - 到期时间
  - 释放时间（到期后24小时）
  - 节点ID
  - 备注
  - 操作按钮
- AND 应该支持筛选：普通IP/原生IP、通道、国家等
- AND 应该有批量导出功能（CSV/TXT格式）
- AND 应该有续费功能
- AND 与 985Proxy API `/res_static/` 集成

#### REQ-008: 静态IP批量导出
**优先级**: 🟡 High  
**作为** 用户  
**我想要** 批量导出我的静态IP列表  
**以便** 在其他工具中使用

**接受标准**:
- WHEN 点击导出按钮时
- THEN 应该弹出格式选择对话框（CSV或TXT）
- AND 导出格式应该为：IP:端口:账号:密码（参考图五）
- AND 文件应该自动下载

#### REQ-009: 静态住宅选购页面
**优先级**: 🔴 Critical  
**作为** 用户  
**我想要** 购买静态代理IP  
**以便** 获取代理服务

**接受标准**:
- WHEN 访问静态住宅选购页面时
- THEN 应该显示IP类型选择：普通IP和原生IP
- AND 普通IP价格：
  - 30天: $5
  - 60天: $10
  - 90天: $15
  - 180天: $30
  - （以此类推）
- AND 原生IP价格：
  - 30天: $8
  - 60天: $16
  - 90天: $24
  - 180天: $48
  - （以此类推）
- AND 应该显示地区选择：
  - 欧洲
  - 南美洲
  - 亚洲
  - 北美洲
- AND 每个国家卡片应该显示：
  - 国旗图标
  - 国家和城市名称
  - 可用数量
  - 价格
- AND 右侧应该有支付面板，显示：
  - 总IP数
  - 有效期间
  - 总计费用
  - 总计优惠
  - 支付费用
  - 支付方式选择
  - 钱包余额
- AND 与 985Proxy API `/res_static/buy` 集成

---

### 2.5 钱包与充值

#### REQ-010: 钱包充值页面（审核模式）
**优先级**: 🔴 Critical  
**作为** 用户  
**我想要** 充值我的账户余额  
**以便** 购买代理服务

**接受标准**:
- WHEN 访问钱包充值页面时
- THEN 应该显示充值金额输入
- AND 应该有优惠券输入选项
- AND 应该显示支付方式选择：
  - 微信支付
  - 支付宝支付
  - USDT支付
- AND 当选择美金金额时
- THEN 应该自动显示人民币换算（基于当前汇率）
- AND 提交后应该进入管理员审核流程
- AND 管理员批准后，金额应该自动到账

---

### 2.6 账单与交易

#### REQ-011: 费用明细页面
**优先级**: 🟡 High  
**作为** 用户  
**我想要** 查看我的费用明细  
**以便** 了解我的支出情况

**接受标准**:
- WHEN 访问费用明细页面时
- THEN 应该显示费用统计卡片：
  - 总数
  - 日均费用
  - 今天费用
  - 产品数
- AND 应该显示费用表格（按日期）：
  - 动态住宅
  - 数据中心
  - 双ISP静态住宅
  - 移动代理
  - 总计
- AND 应该支持日期范围筛选
- AND 应该支持分页

#### REQ-012: 交易明细页面
**优先级**: 🟡 High  
**作为** 用户  
**我想要** 查看我的交易记录  
**以便** 了解我的资金流动

**接受标准**:
- WHEN 访问交易明细页面时
- THEN 应该显示交易列表：
  - 交易时间
  - 交易类型（短期结算/购买静态IP/账户充值）
  - 金额
  - 账户余额
  - 备注
- AND 应该支持交易类型筛选
- AND 应该支持日期范围筛选

#### REQ-013: 结算记录页面
**优先级**: 🟡 High  
**作为** 用户  
**我想要** 查看我的结算记录  
**以便** 了解我的账单情况

**接受标准**:
- WHEN 访问结算记录页面时
- THEN 应该显示结算列表：
  - 结算日期
  - 各类代理费用
  - 总计
  - 查看详情按钮
- AND 应该支持日期范围筛选

#### REQ-014: 充值订单页面
**优先级**: 🟡 High  
**作为** 用户  
**我想要** 查看我的充值订单  
**以便** 追踪充值状态

**接受标准**:
- WHEN 访问充值订单页面时
- THEN 应该显示充值订单列表：
  - 订单号
  - 交易号
  - 支付金额
  - 到账金额
  - 关金汇率
  - 支付方式
  - 手续费
  - 优惠券
  - 下单时间
- AND 应该支持筛选和搜索

---

### 2.7 账户管理

#### REQ-015: 账户中心页面
**优先级**: 🟡 High  
**作为** 用户  
**我想要** 管理我的账户信息  
**以便** 更新个人资料和查看统计

**接受标准**:
- WHEN 访问账户中心页面时
- THEN 应该显示用户信息：
  - 邮箱
  - 昵称
  - 角色
  - 账户余额
  - 赠送余额
  - API Key（可生成/重置）
- AND 应该支持更改密码

#### REQ-016: 事件日志页面
**优先级**: 🟢 Medium  
**作为** 用户  
**我想要** 查看我的账户操作日志  
**以便** 追踪我的账户活动

**接受标准**:
- WHEN 访问事件日志页面时
- THEN 应该显示操作日志列表
- AND 应该显示时间、类型、详情

#### REQ-017: 通知设置页面
**优先级**: 🟢 Medium  
**作为** 用户  
**我想要** 配置我的通知偏好  
**以便** 接收重要信息

**接受标准**:
- WHEN 访问通知设置页面时
- THEN 应该显示通知开关：
  - 通道限制通知
  - 余额不足通知
  - 计划到期通知
  - IP到期通知
- AND 设置应该保存到数据库

---

### 2.8 管理后台

#### REQ-018: 管理后台功能
**优先级**: 🔴 Critical  
**作为** 管理员  
**我想要** 管理平台运营  
**以便** 处理用户请求和监控系统

**接受标准**:
- 用户管理：查看、编辑、禁用用户
- 充值审核：审批用户充值请求
- 订单管理：查看所有订单
- IP管理：管理代理IP资源
- 数据统计：查看平台统计数据
- 系统设置：配置价格、汇率等参数

---

## 3. 技术需求

### 3.1 985Proxy API 集成

#### REQ-019: 静态代理API集成
**优先级**: 🔴 Critical  
**作为** 系统  
**我需要** 集成 985Proxy 静态代理API  
**以便** 提供代理服务

**API 端点**:
- GET `/res_static/ip_list` - 获取IP列表
- GET `/res_static/ip_detail` - 获取IP详情
- GET `/res_static/business_list` - 获取业务场景列表
- GET `/res_static/inventory` - 获取IP库存
- POST `/res_static/buy` - 购买IP
- POST `/res_static/renew` - 续期IP
- POST `/res_static/calculate` - 计算价格
- POST `/res_static/order_result` - 获取订单结果

#### REQ-020: 动态代理API集成
**优先级**: 🟡 High  
**作为** 系统  
**我需要** 集成 985Proxy 动态代理API  
**以便** 提供动态代理信息

**API 端点**:
- GET `/res_rotating/city_list` - 获取地区列表
- GET `/res_rotating/extract` - 提取代理

### 3.2 数据可视化

#### REQ-021: ECharts 图表集成
**优先级**: 🔴 Critical  
**作为** 开发者  
**我需要** 集成 ECharts 图表库  
**以便** 显示数据可视化

**图表类型**:
- 条形图（Bar Chart）
- 饼状图（Pie Chart）
- 折线图（Line Chart）

### 3.3 国际化支持

#### REQ-022: 国家/地区显示
**优先级**: 🟡 High  
**作为** 用户  
**我想要** 看到国家旗帜图标  
**以便** 快速识别地区

**接受标准**:
- 使用 `country-flag-icons` 库
- 支持所有 985Proxy API 返回的国家代码

---

## 4. 非功能需求

### 4.1 性能

- 页面加载时间应该 < 2秒
- API 响应时间应该 < 1秒
- 图表渲染应该流畅

### 4.2 安全

- 所有 API 请求需要 JWT 认证
- 敏感数据（如密码）需要加密
- 管理后台需要额外的权限验证

### 4.3 兼容性

- 支持现代浏览器（Chrome、Firefox、Safari、Edge）
- 响应式设计，支持移动设备

### 4.4 可维护性

- 代码应该遵循 TypeScript 最佳实践
- 使用 Git 版本控制
- 所有功能应该有清晰的注释

---

## 5. 约束条件

1. 必须使用现有的技术栈（NestJS + Vue 3）
2. 必须与 985Proxy API 完全兼容
3. 必须保持与原项目的视觉一致性
4. 不能跳过任何原项目中已有的功能

---

## 6. 假设

1. 985Proxy API 文档是最新且准确的
2. 用户已有 985Proxy API Key
3. 原项目的所有功能都是必需的

---

## 7. 依赖

- 985Proxy 开放 API 服务
- PostgreSQL 数据库
- Redis 缓存
- Docker 环境

---

## 8. 验收测试

### 8.1 仪表盘测试
- [ ] 条形图正确显示数据
- [ ] 饼状图正确显示数据
- [ ] 折线图正确显示数据
- [ ] 日期筛选器工作正常

### 8.2 静态代理测试
- [ ] 可以购买静态IP
- [ ] 可以查看IP列表
- [ ] 可以导出IP列表
- [ ] 可以续费IP

### 8.3 动态代理测试
- [ ] 可以查看通道列表
- [ ] 价格表正确显示

### 8.4 充值测试
- [ ] 可以提交充值申请
- [ ] 汇率自动转换正确
- [ ] 管理员可以审核

### 8.5 账单测试
- [ ] 费用明细正确显示
- [ ] 交易明细正确显示
- [ ] 结算记录正确显示
- [ ] 充值订单正确显示

---

## 9. 附录

### 9.1 术语表

- **动态住宅**: Rotating Residential Proxy
- **静态住宅**: Static Residential Proxy  
- **双ISP**: Dual ISP Static Residential
- **原生IP**: Premium IP
- **普通IP**: Shared IP
- **UTC**: 协调世界时

### 9.2 参考文档

- 985Proxy 开放 API 文档.md
- 985proxy-openapi-v20251016.pdf
- 原项目截图（图一至图十四）

---

**文档结束**

