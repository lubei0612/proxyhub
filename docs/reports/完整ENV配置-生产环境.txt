# ============================================
# ProxyHub 生产环境配置文件
# 文件位置: backend/.env
# ============================================

# --------------------------------------------
# 1. 数据库配置 (PostgreSQL)
# --------------------------------------------
DATABASE_HOST=localhost
DATABASE_PORT=5432
DATABASE_USER=postgres
DATABASE_PASSWORD=postgres123
DATABASE_NAME=proxyhub

# 同步模式 (生产环境建议false，使用migration)
DATABASE_SYNC=false

# --------------------------------------------
# 2. Redis配置
# --------------------------------------------
REDIS_HOST=localhost
REDIS_PORT=6379
# REDIS_PASSWORD=your_redis_password  # 如果有密码

# --------------------------------------------
# 3. JWT认证配置
# --------------------------------------------
JWT_SECRET=your-super-secret-jwt-key-change-this-in-production-use-long-random-string
JWT_EXPIRES_IN=2h
JWT_REFRESH_EXPIRES_IN=7d

# --------------------------------------------
# 4. 服务端口配置
# --------------------------------------------
PORT=3000
API_PREFIX=/api/v1

# --------------------------------------------
# 5. 985Proxy API配置 ⭐ 重要
# --------------------------------------------
# 正确的API KEY（不包含Zone ID）
PROXY_985_API_KEY=ne_hj06qomI-bmVfaGowNnFvbUk0YzIzMTc2MTQ1Nzk1Mw==

# API网关地址
PROXY_985_BASE_URL=https://open-api.985proxy.com

# Zone ID（通道ID）
PROXY_985_ZONE=6jd4ftbl7kv3

# 测试模式 (false=生产模式，会实际扣费)
PROXY_985_TEST_MODE=false

# --------------------------------------------
# 6. 邮件服务配置 (主邮箱 - Outlook)
# --------------------------------------------
MAIL_HOST=smtp.office365.com
MAIL_PORT=587
MAIL_USER=your-outlook@outlook.com
MAIL_PASSWORD=your-outlook-app-password
MAIL_FROM=ProxyHub <noreply@proxyhub.com>

# --------------------------------------------
# 7. 备用邮箱配置 (Gmail)
# --------------------------------------------
MAIL_HOST_BACKUP=smtp.gmail.com
MAIL_PORT_BACKUP=587
MAIL_USER_BACKUP=your-gmail@gmail.com
MAIL_PASSWORD_BACKUP=your-gmail-app-password

# --------------------------------------------
# 8. Telegram Bot配置 (可选)
# --------------------------------------------
TELEGRAM_BOT_TOKEN=your_telegram_bot_token
TELEGRAM_BOT_USERNAME=YourBotUsername

# --------------------------------------------
# 9. 应用环境
# --------------------------------------------
NODE_ENV=production

# --------------------------------------------
# Docker部署额外配置 (在docker-compose.yml中使用)
# --------------------------------------------
# 以下变量在Docker环境中会自动设置
# DATABASE_HOST=postgres  # 容器内使用服务名
# REDIS_HOST=redis        # 容器内使用服务名

# ============================================
# 腾讯云生产环境配置建议
# ============================================

# 1. 数据库配置（使用腾讯云PostgreSQL）
# DATABASE_HOST=您的腾讯云数据库内网IP
# DATABASE_PORT=5432
# DATABASE_USER=生产环境用户名
# DATABASE_PASSWORD=强密码-至少16位-包含大小写数字特殊字符
# DATABASE_NAME=proxyhub_prod

# 2. Redis配置（使用腾讯云Redis）
# REDIS_HOST=您的腾讯云Redis内网IP
# REDIS_PORT=6379
# REDIS_PASSWORD=Redis密码

# 3. JWT Secret（生产环境必须更换）
# 使用以下命令生成随机密钥：
# node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"

# 4. 邮件服务（建议使用企业邮箱）
# 如果使用腾讯企业邮箱：
# MAIL_HOST=smtp.exmail.qq.com
# MAIL_PORT=465 或 587

# ============================================
# 安全检查清单
# ============================================
# [ ] 更改所有默认密码
# [ ] JWT_SECRET使用64位以上随机字符串
# [ ] 数据库密码至少16位，包含大小写数字特殊字符
# [ ] 不要在代码仓库中提交真实的.env文件
# [ ] 确保.env文件在.gitignore中
# [ ] 生产环境DATABASE_SYNC=false
# [ ] 生产环境NODE_ENV=production
# [ ] 确认985Proxy API KEY和ZONE正确
# [ ] 邮件服务测试通过
# [ ] Redis连接测试通过
# [ ] 数据库连接测试通过

# ============================================
# 快速测试命令
# ============================================
# 测试数据库连接：
# psql -h DATABASE_HOST -U DATABASE_USER -d DATABASE_NAME

# 测试Redis连接：
# redis-cli -h REDIS_HOST -p REDIS_PORT ping

# 测试后端启动：
# cd backend && npm run start:dev

# 测试API健康检查：
# curl http://localhost:3000/api/v1/health

