# ç®¡ç†åå°è·¯ç”±ä¿®å¤éªŒè¯æŒ‡å—

**ä¿®å¤æ—¥æœŸ**: 2025-11-05  
**é—®é¢˜**: è®¿é—®`/admin/dashboard`è‡ªåŠ¨é‡å®šå‘åˆ°ç”¨æˆ·ä»ªè¡¨ç›˜  
**çŠ¶æ€**: âœ… å·²ä¿®å¤

---

## ğŸ”§ ä¿®å¤å†…å®¹

### 1. è·¯ç”±å®ˆå«ä¿®å¤
**æ–‡ä»¶**: `frontend/src/router/index.ts`

**ä¿®å¤ç‚¹**:
1. âœ… å…¼å®¹ä¸¤ä¸ªlocalStorage key (`userInfo`å’Œ`user`)
2. âœ… æ·»åŠ è¯¦ç»†çš„consoleæ—¥å¿—ç”¨äºè°ƒè¯•
3. âœ… æ”¹è¿›ç®¡ç†å‘˜æƒé™æ£€æŸ¥é€»è¾‘
4. âœ… ç™»å½•åæ ¹æ®è§’è‰²è·³è½¬åˆ°æ­£ç¡®é¡µé¢

**å…³é”®ä»£ç **:
```typescript
// å…¼å®¹ä¸¤ä¸ªä¸åŒçš„key
const userInfoStr = localStorage.getItem('userInfo') || localStorage.getItem('user');
let user = null;

try {
  user = userInfoStr ? JSON.parse(userInfoStr) : null;
} catch (e) {
  console.error('Failed to parse user info:', e);
}

// æ£€æŸ¥ç®¡ç†å‘˜æƒé™
if (to.meta.requiresAdmin) {
  if (!user || user.role !== 'admin') {
    console.warn('[Router Guard] Access denied: User is not admin');
    next({ name: 'Dashboard' });
    return;
  }
  console.log('[Router Guard] Admin access granted');
}
```

---

## ğŸ§ª éªŒè¯æ­¥éª¤

### å‰ç½®æ¡ä»¶
1. âœ… æœåŠ¡å·²å¯åŠ¨ï¼ˆä½¿ç”¨`å¯åŠ¨ProxyHub-æœ€ç»ˆç‰ˆ.bat`ï¼‰
2. âœ… æµè§ˆå™¨æ‰“å¼€ http://localhost:8080
3. âœ… æŒ‰F12æ‰“å¼€å¼€å‘è€…å·¥å…·

### æ­¥éª¤1: æ¸…é™¤ç¼“å­˜é‡æ–°ç™»å½•
```javascript
// åœ¨Consoleä¸­æ‰§è¡Œ
localStorage.clear();
location.reload();
```

### æ­¥éª¤2: ä½¿ç”¨ç®¡ç†å‘˜è´¦æˆ·ç™»å½•
- é‚®ç®±: `admin@example.com`
- å¯†ç : `admin123`

### æ­¥éª¤3: æ£€æŸ¥Consoleæ—¥å¿—
ç™»å½•æˆåŠŸåï¼Œåº”è¯¥çœ‹åˆ°ç±»ä¼¼æ—¥å¿—ï¼š
```
[Router Guard] Navigating to: /admin/dashboard
[Router Guard] User: {id: 1, email: "admin@example.com", role: "admin", ...}
[Router Guard] User Role: admin
[Router Guard] Requires Admin: true
[Router Guard] Admin access granted
```

### æ­¥éª¤4: è®¿é—®ç®¡ç†åå°
```
æ–¹æ³•1: æµè§ˆå™¨åœ°å€æ è¾“å…¥
http://localhost:8080/admin/dashboard

æ–¹æ³•2: åœ¨Consoleæ‰§è¡Œ
location.href = '/admin/dashboard';
```

### æ­¥éª¤5: éªŒè¯æˆåŠŸæ ‡å¿—
âœ… é¡µé¢æ˜¾ç¤º"ç®¡ç†ä»ªè¡¨ç›˜"
âœ… å·¦ä¾§èœå•æ˜¾ç¤ºç®¡ç†åå°ä¸“ç”¨èœå•
âœ… æ˜¾ç¤ºç»Ÿè®¡æ•°æ®ï¼ˆç”¨æˆ·æ•°ã€æ”¶å…¥ã€è®¢å•æ•°ç­‰ï¼‰
âœ… æ˜¾ç¤ºå¾…å¤„ç†äº‹é¡¹
âœ… æ˜¾ç¤ºæœ€è¿‘è®¢å•

---

## ğŸ” æ•…éšœæ’æŸ¥

### é—®é¢˜1: ä»ç„¶é‡å®šå‘åˆ°ç”¨æˆ·ä»ªè¡¨ç›˜
**æ£€æŸ¥**:
```javascript
// Consoleæ‰§è¡Œ
console.log('Token:', localStorage.getItem('token'));
console.log('User:', localStorage.getItem('user'));
console.log('UserInfo:', localStorage.getItem('userInfo'));
```

**ç¡®è®¤**:
- Tokenå­˜åœ¨
- useræˆ–userInfoå­˜åœ¨ä¸”åŒ…å«`role: "admin"`

**è§£å†³**:
```javascript
// é‡æ–°ç™»å½•
localStorage.clear();
location.href = '/login';
```

### é—®é¢˜2: Consoleæ˜¾ç¤º"Access denied"
**åŸå› **: å½“å‰ç”¨æˆ·ä¸æ˜¯ç®¡ç†å‘˜

**æ£€æŸ¥ç”¨æˆ·è§’è‰²**:
```javascript
const user = JSON.parse(localStorage.getItem('userInfo') || localStorage.getItem('user'));
console.log('Current Role:', user.role);
```

**æœŸæœ›è¾“å‡º**: `Current Role: admin`

**è§£å†³**: ä½¿ç”¨æ­£ç¡®çš„ç®¡ç†å‘˜è´¦æˆ·ç™»å½•

### é—®é¢˜3: é¡µé¢ç©ºç™½
**æ£€æŸ¥**:
1. æ‰“å¼€Networkæ ‡ç­¾
2. æŸ¥çœ‹æ˜¯å¦æœ‰404é”™è¯¯
3. æŸ¥çœ‹Consoleæ˜¯å¦æœ‰JavaScripté”™è¯¯

**å¸¸è§åŸå› **:
- ç»„ä»¶æ–‡ä»¶è·¯å¾„é”™è¯¯
- å‰ç«¯æœåŠ¡æœªæ­£å¸¸å¯åŠ¨

---

## ğŸ“Š æµ‹è¯•ç”¨ä¾‹

### æµ‹è¯•ç”¨ä¾‹1: ç®¡ç†å‘˜è®¿é—®ç®¡ç†åå°
- **å‰ç½®æ¡ä»¶**: ä½¿ç”¨admin@example.comç™»å½•
- **æ“ä½œ**: è®¿é—® `/admin/dashboard`
- **é¢„æœŸç»“æœ**: âœ… æˆåŠŸæ˜¾ç¤ºç®¡ç†ä»ªè¡¨ç›˜
- **å®é™…ç»“æœ**: _____

### æµ‹è¯•ç”¨ä¾‹2: æ™®é€šç”¨æˆ·è®¿é—®ç®¡ç†åå°
- **å‰ç½®æ¡ä»¶**: ä½¿ç”¨user@example.comç™»å½•
- **æ“ä½œ**: è®¿é—® `/admin/dashboard`
- **é¢„æœŸç»“æœ**: âŒ é‡å®šå‘åˆ° `/dashboard`
- **å®é™…ç»“æœ**: _____

### æµ‹è¯•ç”¨ä¾‹3: æœªç™»å½•è®¿é—®ç®¡ç†åå°
- **å‰ç½®æ¡ä»¶**: æœªç™»å½•
- **æ“ä½œ**: è®¿é—® `/admin/dashboard`
- **é¢„æœŸç»“æœ**: âŒ é‡å®šå‘åˆ° `/login?redirect=/admin/dashboard`
- **å®é™…ç»“æœ**: _____

---

## âœ… éªŒæ”¶æ ‡å‡†

ç®¡ç†åå°è·¯ç”±ä¿®å¤æˆåŠŸçš„æ ‡å‡†ï¼š

1. âœ… ç®¡ç†å‘˜å¯ä»¥ç›´æ¥è®¿é—® `/admin/dashboard`
2. âœ… æ™®é€šç”¨æˆ·è®¿é—®ç®¡ç†åå°æ—¶è¢«æ‹’ç»
3. âœ… æœªç™»å½•ç”¨æˆ·è·³è½¬åˆ°ç™»å½•é¡µ
4. âœ… ç™»å½•åè‡ªåŠ¨è·³è½¬å›åŸç›®æ ‡é¡µé¢
5. âœ… Consoleæ—¥å¿—æ¸…æ™°æ˜¾ç¤ºè·¯ç”±å®ˆå«é€»è¾‘
6. âœ… æ²¡æœ‰æ— é™é‡å®šå‘å¾ªç¯

---

## ğŸ“ å…¶ä»–è¯´æ˜

### é‚®ä»¶å‘é€é—®é¢˜
**çŠ¶æ€**: âš ï¸ éœ€è¦æ‰‹åŠ¨éªŒè¯

**Gmailé…ç½®**:
- SMTPæœåŠ¡å™¨: smtp.gmail.com:587
- è´¦æˆ·: chenyuqi061245@gmail.com
- åº”ç”¨ä¸“ç”¨å¯†ç : å·²é…ç½®

**éªŒè¯æ­¥éª¤**:
1. ç™»å½•Gmail: https://mail.google.com
2. æ£€æŸ¥æ”¶ä»¶ç®±
3. æ£€æŸ¥åƒåœ¾é‚®ä»¶æ–‡ä»¶å¤¹
4. æœç´¢"ProxyHub"

**å¦‚æœæœªæ”¶åˆ°é‚®ä»¶**:
å¯èƒ½åŸå› ï¼š
1. Gmailå®‰å…¨è®¾ç½®æ‹¦æˆª
2. åº”ç”¨ä¸“ç”¨å¯†ç è¿‡æœŸ
3. SMTPé…ç½®é”™è¯¯

å»ºè®®ï¼š
- æ£€æŸ¥Gmail"ä¸å¤Ÿå®‰å…¨çš„åº”ç”¨"è®¾ç½®
- é‡æ–°ç”Ÿæˆåº”ç”¨ä¸“ç”¨å¯†ç 
- æŸ¥çœ‹åç«¯æ—¥å¿—ç¡®è®¤å‘é€çŠ¶æ€

---

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœä¿®å¤åä»æœ‰é—®é¢˜ï¼š
1. æä¾›Consoleå®Œæ•´æ—¥å¿—
2. æä¾›Networkæ ‡ç­¾æˆªå›¾
3. æä¾›localStorageå†…å®¹

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**æœ€åæ›´æ–°**: 2025-11-05 16:00

