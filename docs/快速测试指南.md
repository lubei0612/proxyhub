# ProxyHub 快速测试指南

## 🚀 快速开始测试

### 前置条件
确保以下服务正在运行：
- ✅ 数据库 (PostgreSQL + Redis)
- ✅ 后端 (NestJS - 端口 3000)
- ✅ 前端 (Vue 3 - 端口 8080)

---

## 步骤 1: 启动所有服务

### 方法 A: 使用一键启动脚本
```bash
双击运行: 启动ProxyHub.bat
```

### 方法 B: 手动启动（如果脚本失败）

**1. 启动数据库**
```bash
双击运行: start-database.bat
# 或
docker-compose up -d
```

**2. 启动后端**
```bash
双击运行: start-backend.bat
# 或
cd backend
npm run start:dev
```

**3. 启动前端**
```bash
双击运行: start-frontend.bat
# 或
cd frontend
npm run dev
```

### 验证服务状态
```bash
# 检查端口占用
netstat -ano | findstr "3000"    # 后端
netstat -ano | findstr "8080"    # 前端
netstat -ano | findstr "5432"    # PostgreSQL
netstat -ano | findstr "6379"    # Redis
```

---

## 步骤 2: 测试 API（可选）

在项目根目录运行：
```bash
node test-api.js
```

**预期输出：**
```
==============================================
  ProxyHub API 测试开始
==============================================

📝 测试用户登录: test@test.com
✅ 登录成功！
   Token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
   
👤 测试用户信息API
✅ 用户信息获取成功！

📊 测试仪表盘API
✅ 仪表盘数据获取成功！

📝 测试管理员登录: admin@proxy.com
✅ 登录成功！
...
```

---

## 步骤 3: 浏览器测试

### A. 普通用户流程测试

**1. 打开浏览器**
访问: http://localhost:8080

**2. 测试登录**
- 邮箱: `test@test.com`
- 密码: `test123456`
- 点击"登录"按钮

**3. 测试主菜单导航**
依次点击以下菜单项，验证页面正常显示：

| 菜单项 | 子菜单 | 预期结果 |
|--------|--------|----------|
| 📊 仪表盘 | - | 显示仪表盘页面 |
| ⚡ 动态住宅 | 动态住宅选购 | 显示动态代理购买页面 |
| | 动态住宅管理 | 显示动态代理管理页面 |
| 🏠 静态住宅 | 静态住宅选购 | 显示静态代理购买页面 |
| | 静态住宅管理 | 显示静态代理管理页面 |
| 📱 移动代理 | - | 显示"未开发"提示 |
| 💰 钱包充值 | - | 显示充值页面 |
| 📋 账单明细 | 订单管理 | 显示订单页面 |
| | 交易明细 | 显示交易明细页面 |
| | 结算记录 | 显示结算记录页面 |
| | 充值订单 | 显示充值订单页面 |
| 👤 我的账户 | 账户中心 | 显示账户中心页面 |
| | 事件日志 | 显示事件日志页面 |
| | 个人中心 | 显示个人中心页面 |
| | 我的代理 | 显示我的代理页面 |
| 🔔 通知管理 | - | 显示通知页面 |

**4. 测试用户下拉菜单**
- 点击右上角用户邮箱
- 验证下拉菜单显示：
  - ✅ 个人资料
  - ✅ 退出登录
  - ❌ 管理后台（普通用户不应看到）

**5. 测试余额显示**
- 检查右上角余额显示: `余额: $1000.00`

---

### B. 管理员流程测试

**1. 退出当前登录**
- 点击右上角用户邮箱
- 点击"退出登录"

**2. 管理员登录**
- 邮箱: `admin@proxy.com`
- 密码: `admin123456`
- 点击"登录"按钮

**3. 验证管理后台链接**
- 点击右上角用户邮箱
- 验证下拉菜单显示：
  - ✅ 个人资料
  - ✅ **管理后台** ← 管理员专属
  - ✅ 退出登录

**4. 进入管理后台**
- 点击"管理后台"
- **应该跳转到**: http://localhost:8080/admin/dashboard
- **应该看到**: 深色主题的管理后台界面

**5. 测试管理后台菜单**
验证左侧菜单显示：
- ✅ 📊 仪表盘 (`/admin/dashboard`)
- ✅ 👥 用户管理 (`/admin/users`)
- ✅ 💵 充值审核 (`/admin/recharges`)
- ✅ 📝 订单管理 (`/admin/orders`)
- ✅ ⚙️ 系统设置 (`/admin/settings`)

**6. 测试侧边栏折叠**
- 点击顶部导航栏左侧的折叠按钮
- 验证侧边栏收缩为图标模式
- 再次点击，验证侧边栏展开

**7. 测试返回用户端**
- 点击侧边栏底部的"返回用户端"按钮
- 应该跳转回用户端仪表盘

---

## 步骤 4: 权限测试

### 测试场景 1: 普通用户访问管理后台
**操作**:
1. 使用普通用户登录 (`test@test.com`)
2. 手动访问: http://localhost:8080/admin/dashboard

**预期结果**: 
- ❌ 无法访问
- ✅ 自动重定向到用户端仪表盘

### 测试场景 2: 未登录访问受保护页面
**操作**:
1. 退出登录
2. 手动访问: http://localhost:8080/dashboard

**预期结果**:
- ❌ 无法访问
- ✅ 自动重定向到登录页面

---

## 步骤 5: UI/UX 测试

### 测试响应式设计
1. 调整浏览器窗口大小
2. 验证：
   - ✅ 侧边栏适应窗口高度
   - ✅ 内容区域适应窗口宽度
   - ✅ 菜单项正常显示和点击

### 测试多级菜单
1. 点击"动态住宅"菜单
2. 验证子菜单展开
3. 点击子菜单项
4. 验证页面正确跳转
5. 验证当前菜单项高亮

### 测试加载状态
1. 快速切换多个菜单
2. 观察是否有加载提示
3. 验证页面切换流畅

---

## 测试清单 ✅

### 基础功能
- [ ] 用户登录成功
- [ ] 管理员登录成功
- [ ] 用户注册成功（如果实现）
- [ ] 退出登录成功
- [ ] Token 自动保存和加载

### 导航功能
- [ ] 所有用户端菜单可访问
- [ ] 所有管理后台菜单可访问
- [ ] 多级菜单正常展开/折叠
- [ ] 当前路由菜单高亮
- [ ] 面包屑导航正确

### 权限控制
- [ ] 普通用户看不到"管理后台"菜单
- [ ] 管理员可以看到"管理后台"菜单
- [ ] 普通用户无法访问 `/admin/*` 路由
- [ ] 未登录无法访问受保护路由
- [ ] 权限验证后自动重定向

### UI/UX
- [ ] 页面布局美观
- [ ] 颜色搭配合理
- [ ] 响应式设计正常
- [ ] 加载状态提示清晰
- [ ] 错误提示友好
- [ ] 菜单展开/折叠动画流畅

### 管理后台特性
- [ ] 暗色主题正常显示
- [ ] 侧边栏可折叠
- [ ] 返回用户端功能正常
- [ ] 管理员信息显示正确
- [ ] 独立的 URL 路径

---

## 常见问题排查

### 问题 1: 前端白屏
**可能原因**:
- 前端服务未启动
- API 请求失败
- 路由配置错误

**解决方法**:
1. 检查浏览器控制台 (F12) 的错误信息
2. 确认前端服务正在运行: `netstat -ano | findstr "8080"`
3. 检查 Network 面板的 API 请求状态

### 问题 2: 登录后跳转失败
**可能原因**:
- 后端未启动
- API 返回格式不正确
- Token 保存失败

**解决方法**:
1. 检查后端是否运行: `netstat -ano | findstr "3000"`
2. 打开浏览器控制台，查看 Network 面板
3. 检查 localStorage 中是否保存了 token

### 问题 3: 管理后台无法访问
**可能原因**:
- 用户角色不是 admin
- 路由守卫配置错误

**解决方法**:
1. 确认使用管理员账号登录: `admin@proxy.com`
2. 检查浏览器控制台的错误信息
3. 验证 localStorage 中的用户信息: `localStorage.getItem('user')`

### 问题 4: 菜单不显示
**可能原因**:
- 路由配置缺失
- 页面组件未创建

**解决方法**:
1. 检查 `frontend/src/router/index.ts` 路由配置
2. 确认对应的 Vue 组件文件存在
3. 查看浏览器控制台的组件加载错误

---

## 📊 测试报告模板

完成测试后，请记录以下信息：

```
测试日期: ___________
测试人员: ___________
测试环境: 本地开发环境

【服务状态】
- 数据库: ☐ 正常 ☐ 异常
- 后端: ☐ 正常 ☐ 异常
- 前端: ☐ 正常 ☐ 异常

【功能测试】
- 用户登录: ☐ 通过 ☐ 失败
- 管理员登录: ☐ 通过 ☐ 失败
- 菜单导航: ☐ 通过 ☐ 失败
- 权限控制: ☐ 通过 ☐ 失败

【发现的问题】
1. _________________________
2. _________________________
3. _________________________

【建议改进】
1. _________________________
2. _________________________
3. _________________________
```

---

## 🎯 下一步

测试完成后，可以：

1. **继续实现页面功能**
   - 将占位符页面转换为完整功能
   - 集成 985Proxy API
   - 实现支付流程

2. **部署到生产环境**
   - 配置生产环境变量
   - 使用 Docker 部署
   - 配置域名和 SSL

3. **性能优化**
   - 代码分割
   - 懒加载
   - 缓存优化

4. **持续集成**
   - 设置 CI/CD 流程
   - 自动化测试
   - 自动部署

---

**祝测试顺利！🎉**

