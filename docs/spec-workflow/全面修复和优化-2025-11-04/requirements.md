# ProxyHub 全面修复和优化 - 需求文档

**创建时间**: 2025-11-04  
**优先级**: P0 (关键bug) → P1 (功能完善) → P2 (体验优化)

---

## 📋 问题汇总

### P0 - 关键Bug（必须立即修复）

#### 1. 订单管理路由问题 🔴
**现象**:
- 点击"订单管理"显示的是充值订单界面
- 点击其他页面后无法跳转

**影响**: 用户无法正常使用订单功能
**根因**: 路由配置错误或组件状态问题

#### 2. 续费功能严重Bug 🔴
**现象**:
- 续费30天只增加了2秒
- 续费一个IP后所有IP的时间都增加了
- 续费金额显示NaN

**影响**: 核心功能不可用
**根因**: 续费逻辑错误、时间计算错误

#### 3. 充值订单不显示 🔴
**现象**:
- 用户提交充值订单后，充值审核界面看不到对应订单

**影响**: 管理员无法审核充值
**根因**: API调用问题或数据筛选问题

#### 4. 管理后台仪表盘写死数据 🔴
**现象**:
- 待处理事项（充值审核5、异常订单2、系统通知3）
- 最近订单（ORD001/002/003）
- 所有数据都是mock，不反映真实情况

**影响**: 管理员无法看到真实的待处理事项
**根因**: 未对接后端API

---

### P1 - 功能缺失（影响使用体验）

#### 5. 用户管理筛选功能未生效 🟡
**现象**:
- 用户邮箱搜索不工作
- 角色筛选不工作
- 状态筛选不工作

**需求**: 所有筛选都应该能正常工作

#### 6. 用户管理功能不完整 🟡
**现象**:
- 设置为管理员后无法取消管理员权限
- 缺少赠送金额功能

**需求**:
- 添加"取消管理员"操作
- 添加"赠送余额"功能（单独为用户充值）

#### 7. 充值审核筛选未生效 🟡
**现象**:
- 支付方式筛选不工作
- 用户邮箱搜索不工作

#### 8. 订单管理筛选未生效 🟡
**现象**: 所有筛选功能都不工作

#### 9. 交易明细筛选未生效 🟡
**现象**:
- 时间筛选不工作
- 交易类型筛选不工作

#### 10. 事件日志筛选未生效 🟡
**现象**:
- 事件类型筛选不工作
- 时间筛选不工作

#### 11. 交易时间显示问题 🟡
**现象**: 交易时间与北京时间对不上
**需求**: 需要将UTC时间转换为北京时间（UTC+8）

#### 12. IP释放功能验证 🟡
**需求**: 
- 验证IP释放后是否真的回到IP池
- 验证IP到期后是否自动失效

---

### P2 - 体验优化（可延后处理）

#### 13. 用户仪表盘图表数据 🟢
**现象**:
- 网络使用流量概况
- 网络请求分布
- 使用流量概况折线图
- 都是写死的mock数据

**需求**: 对接真实数据API

#### 14. 中英文切换 🟢
**现象**: 只有中文，没有英文切换功能
**需求**: 实现完整的i18n国际化

#### 15. 手机端适配 🟢
**现象**: 当前手机适配不好，无法正常操作
**需求**: 
- 先设计手机端UI方案
- 确认需求后再实现

#### 16. 动态住宅管理页面 🟢
**需求**: 待用户确认具体需求

---

## 🎯 核心需求

### 1. 数据一致性
- ✅ 所有筛选功能必须生效
- ✅ 所有显示的数据必须来自真实API
- ✅ 用户操作后数据必须实时更新

### 2. 时间处理
- ✅ 所有时间显示转换为北京时间
- ✅ 续费时间计算必须正确
- ✅ 到期时间验证

### 3. 用户管理
- ✅ 完整的角色管理（设置/取消管理员）
- ✅ 赠送余额功能
- ✅ 所有筛选功能生效

### 4. 路由和导航
- ✅ 修复订单管理路由问题
- ✅ 确保所有页面导航正常

---

## 📊 技术要求

### 后端
- 新增API：赠送余额、取消管理员
- 修复API：续费逻辑、充值列表
- 时间处理：统一返回UTC时间

### 前端
- 时间转换：UTC → 北京时间（+8）
- 筛选实现：所有列表页面
- 路由修复：订单管理
- 表单验证：赠送余额

---

## ✅ 验收标准

### P0任务
- [ ] 订单管理路由正常，可以跳转
- [ ] 续费功能正确（时间+30天，金额正确，只影响单个IP）
- [ ] 充值订单提交后立即显示在审核列表
- [ ] 管理后台仪表盘显示真实数据

### P1任务
- [ ] 所有筛选功能正常工作
- [ ] 用户管理可以取消管理员
- [ ] 用户管理可以赠送余额
- [ ] 交易时间显示为北京时间
- [ ] IP释放后回到可用IP池

### P2任务
- [ ] 用户仪表盘图表显示真实数据
- [ ] 中英文切换正常
- [ ] 手机端UI设计方案确认
- [ ] 动态住宅管理需求确认

---

**文档版本**: v1.0  
**下一步**: 创建设计文档


