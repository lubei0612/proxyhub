# ProxyHub 测试执行清单

**测试日期**: 2025-11-04  
**测试人员**: _______________  
**开始时间**: _______________  

---

## 📋 测试前检查清单

- [ ] 后端服务运行正常 (http://localhost:3000)
- [ ] 前端服务运行正常 (http://localhost:8080)
- [ ] 数据库连接正常
- [ ] Chrome浏览器已打开开发者工具 (F12)

---

## 🧪 测试执行 (16项)

### 第一部分：用户端核心功能 (7项)

#### ✅ 测试1: 登录与余额显示
- [ ] **步骤1**: 访问 http://localhost:8080
- [ ] **步骤2**: 使用 admin@example.com / admin123 登录
- [ ] **步骤3**: 检查导航栏余额显示
- [ ] **验证**: Network请求 `/api/v1/users/me`
- [ ] **结果**: ⬜ 通过 ⬜ 失败
- **当前余额**: $_____________
- **备注**: _________________________________

---

#### ✅ 测试2: IP购买功能 (P0-4修复验证)
- [ ] **步骤1**: 导航到"静态住宅选购"
- [ ] **步骤2**: 选择 USA - New York, 数量1, 30天
- [ ] **步骤3**: 检查价格显示（应为$1.00，价格覆盖）
- [ ] **步骤4**: 打开支付面板
- [ ] **步骤5**: 确认支付面板余额 = 导航栏余额 (P0-3验证)
- [ ] **步骤6**: 完成支付
- [ ] **验证**: Network请求 `/api/v1/proxy/static/purchase`
- [ ] **结果**: ⬜ 通过 ⬜ 失败
- **购买前余额**: $_____________
- **购买后余额**: $_____________
- **扣费金额**: $_____________
- **订单号**: _________________________________
- **备注**: _________________________________

---

#### ✅ 测试3: 订单管理页面 (CRITICAL-1修复验证)
- [ ] **步骤1**: 导航到"账单明细" → "订单管理"
- [ ] **步骤2**: 检查是否显示刚才的购买订单
- [ ] **步骤3**: 验证订单在列表顶部（时间倒序，P0-8）
- [ ] **验证**: Network请求 `/api/v1/orders?page=1&limit=20`
- [ ] **结果**: ⬜ 通过 ⬜ 失败
- **订单总数**: _____________
- **最新订单号**: _________________________________
- **订单金额**: $_____________
- **备注**: _________________________________

---

#### ✅ 测试4: 事件日志记录 (CRITICAL-2 + P1-2修复验证)
- [ ] **步骤1**: 导航到"我的账户" → "事件日志"
- [ ] **步骤2**: 检查是否有"IP购买"记录
- [ ] **验证**: Network请求 `/api/v1/event-logs/my?page=1&limit=20`
- [ ] **结果**: ⬜ 通过 ⬜ 失败
- **日志总数**: _____________
- **最新日志类型**: _________________________________
- **日志内容**: _________________________________
- **备注**: _________________________________

---

#### ✅ 测试5: IP续费功能 (P0-1 + CRITICAL-3修复验证)
- [ ] **步骤1**: 导航到"代理管理" → "静态住宅管理"
- [ ] **步骤2**: 点击刚购买的IP的"续费"按钮
- [ ] **步骤3**: 检查续费对话框价格（应为$1.00，非$5.00）
- [ ] **步骤4**: 选择30天，点击"确认续费"
- [ ] **验证**: Network请求 `/api/v1/proxy/static/:id/renew`
- [ ] **结果**: ⬜ 通过 ⬜ 失败
- **对话框显示价格**: $_____________
- **续费前余额**: $_____________
- **续费后余额**: $_____________
- **实际扣费**: $_____________
- **新到期时间**: _________________________________
- **备注**: _________________________________

---

#### ✅ 测试6: IP释放功能 (P0-2修复验证)
- [ ] **步骤1**: 在"静态住宅管理"选择一个IP
- [ ] **步骤2**: 点击"释放"按钮
- [ ] **步骤3**: 确认释放
- [ ] **验证**: Network请求 `/api/v1/proxy/static/:id` (DELETE)
- [ ] **结果**: ⬜ 通过 ⬜ 失败
- **释放的IP**: _________________________________
- **释放前列表数量**: _____________
- **释放后列表数量**: _____________
- **余额变化**: 无变化 ⬜ / 有变化 ⬜
- **备注**: _________________________________

---

#### ✅ 测试7: 充值申请 (P1-2修复验证)
- [ ] **步骤1**: 导航到"账单明细" → "钱包充值"
- [ ] **步骤2**: 输入金额100，选择微信支付
- [ ] **步骤3**: 提交申请
- [ ] **验证**: Network请求 `/api/v1/billing/recharge`
- [ ] **结果**: ⬜ 通过 ⬜ 失败
- **充值订单号**: _________________________________
- **充值金额**: $_____________
- **支付方式**: _________________________________
- **状态**: _________________________________
- **检查事件日志**: ⬜ 有"充值申请"记录
- **备注**: _________________________________

---

### 第二部分：管理端功能 (6项)

#### ✅ 测试8: 充值审核 (P1-2修复验证)
- [ ] **步骤1**: 导航到"管理后台" → "充值审核"
- [ ] **步骤2**: 找到刚提交的充值申请
- [ ] **步骤3**: 点击"批准"按钮，确认
- [ ] **验证**: Network请求 `/api/v1/billing/recharge/:id/approve`
- [ ] **结果**: ⬜ 通过 ⬜ 失败
- **批准前余额**: $_____________
- **批准后余额**: $_____________
- **余额增加**: $_____________
- **状态变化**: 待审核 → 已批准 ⬜
- **检查事件日志**: ⬜ 有"充值审核通过"记录
- **备注**: _________________________________

---

#### ✅ 测试9: 用户管理 - 角色设置 (P0-5修复验证)
- [ ] **步骤1**: 导航到"管理后台" → "用户管理"
- [ ] **步骤2**: 找到普通用户 user@example.com
- [ ] **步骤3**: 点击"设为管理员"，确认
- [ ] **验证**: Network请求 `/api/v1/admin/users/:id/role`
- [ ] **结果**: ⬜ 通过 ⬜ 失败
- **用户ID**: _____________
- **原角色**: _________________________________
- **新角色**: _________________________________
- **列表是否刷新**: ⬜ 是 ⬜ 否
- **检查该用户事件日志**: ⬜ 有"角色变更"记录
- **备注**: _________________________________

---

#### ✅ 测试10: 用户管理 - 禁用用户 (P0-6修复验证)
- [ ] **步骤1**: 在"用户管理"找到一个用户
- [ ] **步骤2**: 点击"禁用"按钮，确认
- [ ] **步骤3**: 再次点击"启用"按钮，确认
- [ ] **验证**: Network请求 `/api/v1/admin/users/:id/status`
- [ ] **结果**: ⬜ 通过 ⬜ 失败
- **用户ID**: _____________
- **禁用操作**: ⬜ 成功
- **启用操作**: ⬜ 成功
- **列表是否刷新**: ⬜ 是 ⬜ 否
- **检查该用户事件日志**: ⬜ 有"账户状态变更"记录
- **备注**: _________________________________

---

#### ✅ 测试11: 用户管理 - 筛选功能 (P0-7修复验证)
- [ ] **步骤1**: 在"用户管理"筛选角色：管理员
- [ ] **步骤2**: 点击"搜索"
- [ ] **步骤3**: 检查Network请求参数
- [ ] **步骤4**: 清除，筛选状态：禁用
- [ ] **步骤5**: 点击"搜索"
- [ ] **验证**: Network请求包含筛选参数
- [ ] **结果**: ⬜ 通过 ⬜ 失败
- **角色筛选请求**: `/api/v1/admin/users?role=admin` ⬜
- **状态筛选请求**: `/api/v1/admin/users?status=disabled` ⬜
- **筛选结果正确**: ⬜ 是 ⬜ 否
- **备注**: _________________________________

---

#### ✅ 测试12: 价格覆盖管理 (P1-1修复验证)
- [ ] **步骤1**: 导航到"价格覆盖管理"
- [ ] **步骤2**: 找到 Japan Tokyo（原生IP）
- [ ] **步骤3**: 修改价格为 12.00
- [ ] **步骤4**: 找到 USA New York（普通IP）
- [ ] **步骤5**: 修改价格为 2.00
- [ ] **步骤6**: 点击"保存修改"
- [ ] **验证**: Network请求 `/api/v1/price/overrides/batch`
- [ ] **结果**: ⬜ 通过 ⬜ 失败
- **Japan Tokyo原生IP价格**: $_____________
- **USA New York普通IP价格**: $_____________
- **刷新后价格保持**: ⬜ 是 ⬜ 否
- **其他地区价格不变**: ⬜ 是 ⬜ 否
- **备注**: _________________________________

**验证价格生效**:
- [ ] 回到"静态住宅选购"
- [ ] 选择Japan Tokyo原生IP，价格应为$12.00/月 ⬜
- [ ] 选择USA New York普通IP，价格应为$2.00/月 ⬜

---

#### ✅ 测试13: 系统设置 (P1-3修复验证)
- [ ] **步骤1**: 导航到"系统设置"
- [ ] **步骤2**: 修改普通IP价格为6.00
- [ ] **步骤3**: 点击"保存价格配置"
- [ ] **步骤4**: 修改最小充值金额为10
- [ ] **步骤5**: 点击"保存充值设置"
- [ ] **步骤6**: 修改客服1 Telegram
- [ ] **步骤7**: 点击"保存客服设置"
- [ ] **步骤8**: 刷新页面验证
- [ ] **验证**: Network请求 `/api/v1/admin/settings/:key`
- [ ] **结果**: ⬜ 通过 ⬜ 失败
- **价格配置保存**: ⬜ 成功
- **充值设置保存**: ⬜ 成功
- **客服设置保存**: ⬜ 成功
- **刷新后保持**: ⬜ 是 ⬜ 否
- **备注**: _________________________________

---

### 第三部分：数据一致性验证 (3项)

#### ✅ 测试14: 余额一致性 (P0-3修复验证)
- [ ] **步骤1**: 记录导航栏余额
- [ ] **步骤2**: 进入"静态住宅选购"
- [ ] **步骤3**: 打开支付面板
- [ ] **步骤4**: 对比两处余额
- [ ] **结果**: ⬜ 通过 ⬜ 失败
- **导航栏余额**: $_____________
- **支付面板余额**: $_____________
- **是否一致**: ⬜ 是 ⬜ 否
- **差异金额**: $_____________
- **备注**: _________________________________

---

#### ✅ 测试15: 订单数据一致性 (P0-8修复验证)
- [ ] **步骤1**: 购买一个IP
- [ ] **步骤2**: 立即查看"订单管理"
- [ ] **步骤3**: 检查新订单位置
- [ ] **结果**: ⬜ 通过 ⬜ 失败
- **新订单在顶部**: ⬜ 是 ⬜ 否
- **订单按时间倒序**: ⬜ 是 ⬜ 否
- **订单信息完整**: ⬜ 是 ⬜ 否
- **备注**: _________________________________

---

#### ✅ 测试16: 事件日志完整性 (P1-2修复验证)
- [ ] **步骤1**: 查看当前事件日志总数
- [ ] **步骤2**: 执行以下操作并记录
  - [ ] 购买IP → 检查日志 ⬜ 有"IP购买"
  - [ ] 续费IP → 检查日志 ⬜ 有"IP续费"
  - [ ] 释放IP → 检查日志 ⬜ 有"IP释放"
  - [ ] 充值申请 → 检查日志 ⬜ 有"充值申请"
  - [ ] 充值批准 → 检查日志 ⬜ 有"充值审核通过"
  - [ ] 角色变更 → 检查日志 ⬜ 有"角色变更"
  - [ ] 状态变更 → 检查日志 ⬜ 有"账户状态变更"
- [ ] **结果**: ⬜ 通过 ⬜ 失败
- **事件类型覆盖**: _____/8 种
- **日志按时间倒序**: ⬜ 是 ⬜ 否
- **日志内容详细**: ⬜ 是 ⬜ 否
- **备注**: _________________________________

---

## 📊 测试结果汇总

### 通过/失败统计
- **用户端功能**: _____/7 通过
- **管理端功能**: _____/6 通过
- **数据一致性**: _____/3 通过
- **总计**: _____/16 通过

### 通过率
- **百分比**: _____%

### 发现的问题

| 序号 | 测试项 | 问题描述 | 严重程度 | 截图 |
|------|--------|----------|----------|------|
| 1 | | | ⬜ 高 ⬜ 中 ⬜ 低 | |
| 2 | | | ⬜ 高 ⬜ 中 ⬜ 低 | |
| 3 | | | ⬜ 高 ⬜ 中 ⬜ 低 | |

---

## ✅ 测试完成签字

- **测试人员**: _______________
- **完成时间**: _______________
- **总体评价**: ⬜ 优秀 ⬜ 良好 ⬜ 合格 ⬜ 不合格

**备注**:
_______________________________________________
_______________________________________________
_______________________________________________


